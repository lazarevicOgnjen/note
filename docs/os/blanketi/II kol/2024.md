<img width="921" height="340" alt="image" src="https://github.com/user-attachments/assets/af052e2c-be36-4eaa-8a55-2d82c64ce66d" />

<br><br>

> **1 zadatak**

```

#include <stdio.h>
#include <stdlib.h>
#include <sys/ipc.h>
#include <sys/msg.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <string.h>

struct mymsgbuf{ // ovo mora

	long mtype; 
  	char mtext[255];

};

int main(int argc, char* argv[]){

	FILE *f, *f1, *f2;
	pid_t pid1, pid2;
  int msgid;
  struct mymsgbuf bafer;
  
  char recenica[255];
  
  msgid = msgget(10104, 0666 | IPC_CREAT);
  
  pid1 = fork();
  
  if(pid1 == 0){ // 1 dete
  	f1 = fopen("prva.txt", "w");
  	while(msgrcv(msgid, &bafer, sizeof(bafer.mtext), 1, 0) > 0){

	if(strcmp(bafer.mtext, "done") == 0){break;}
	fprintf(f1, "%s", bafer.mtext);
	
	}
	fclose(f1);
	exit(0);
  }

  pid2 = fork();
  
  if(pid2 == 0){ // 2 dete
  	f2 = fopen("druga.txt", "w");
	while(msgrcv(msgid, &bafer, sizeof(bafer.mtext), 2, 0) > 0){
	
	if(strcmp(bafer.mtext, "done") == 0){break;}
	fprintf(f2, "%s", bafer.mtext);

	}
	fclose(f2);
	exit(0);
  }
  
  // roditelj
  f = fopen(argv[1], "r"); // citamo iz fajla
  if(f){
  	
    while( !feof(f) ){
	fgets(recenica, sizeof(recenica), f);
	strcpy(bafer.mtext, recenica);
	if(recenica[0] == 'Z' || recenica[0] == 'z'){
		bafer.mtype = 1;
	}else{
		bafer.mtype = 2;
	}
	msgsnd(msgid, &bafer, strlen(bafer.mtext)+1, 0);
    }

	bafer.mtype = 1;
	strcpy(bafer.mtext, "done");
	msgsnd(msgid, &bafer, strlen(bafer.mtext)+1, 0);

	bafer.mtype = 2;
	msgsnd(msgid, &bafer, strlen(bafer.mtext)+1, 0);
    
  }
  
  fclose(f);

  wait(NULL);
  wait(NULL);
  msgctl(msgid, IPC_RMID, NULL);


	return 0;
}

```
